(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{195:function(e,t,a){},196:function(e,t,a){},197:function(e,t,a){},198:function(e,t,a){"use strict";a.r(t);a(90);var n=a(0),o=a.n(n),r=a(87),l=a.n(r),s=(a(195),a(196),a(32)),i=a(22),c=a(7),d=a(38),m=a(39),u=a(42),h=a(40),g=a(20),p=a(41),f=(a(197),a(88)),b=[{lat:-30.085215,lng:-58.439112},{lat:-30.085215,lng:-53.169667},{lat:-35.031419,lng:-53.169667},{lat:-35.031419,lng:-58.439112}],v=JSON.stringify(b,null,2),y=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={poligonos:[],actual:b,color:"#ff0000",nombre:"Initial",texto:v,copiado:!1,copiar:"",save_err:!1,json_carga:"",cargar_json_visible:!1,error_json_carga:!1,center:{lat:-33.190363,lng:-56.033073},deshacer:[],arrastrando:!1,keys:{}},a.changeColor=a.changeColor.bind(Object(g.a)(a)),a.handleInputs=a.handleInputs.bind(Object(g.a)(a)),a.resetPoly=a.resetPoly.bind(Object(g.a)(a)),a.savePoly=a.savePoly.bind(Object(g.a)(a)),a.handleUp=a.handleUp.bind(Object(g.a)(a)),a.handleDown=a.handleDown.bind(Object(g.a)(a)),a.refPolis=o.a.createRef(),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"copyToClipboard",value:function(){var e=this;this.refPolis.current.select(),document.execCommand("copy"),this.refPolis.current.blur(),this.setState({copiado:!0},function(){setTimeout(function(){e.setState({copiado:!1})},5e3)})}},{key:"formatear",value:function(e){var t="",a=0;a=e.getLength?e.getLength():e.length;for(var n=0;n<a;n++)if(e.getLength)t+="{"+e.getAt(n).toUrlValue(5)+"}, ";else{var o=e[n];t+="{"+o.lat+","+o.lng+"}, "}return t="["+(t=t.replace(/{/g,'{"lat":').replace(/,/g,', "lng":').replace(/, "lng": /g,",")).substring(0,t.length-1)+"]"}},{key:"savePoly",value:function(){var e=this,t=this.state,a=t.nombre,n=t.color,o=t.poligonos,r=t.actual;a=t.nombre;if(o.find(function(e){return e.nombre.toLowerCase()==a.toLowerCase()})||""==a)return this.setState({save_err:!0}),null;var l={nombre:a,color:n,data:r,texto:this.formatear(r)},s='{"Zones":[';[].concat(Object(c.a)(o),[l]).forEach(function(t){s+='{"Zone":"'.concat(t.nombre,'","Coordinates":'),s+=e.formatear(t.data),s+=',"Color":"'.concat(t.color,'"'),s+="},"}),s=s.substring(0,s.length-1)+"]}",s=JSON.stringify(JSON.parse(s),null,2);var i=this.map.getBounds(),d=Object.keys(i)[0],m=Object.keys(i)[1],u=Object.keys(i[d])[0],h=Object.keys(i[d])[1],g={menor:i[m][u],mayor:i[m][h]},p={menor:i[d][u],mayor:i[d][h]},f=this.map.center.lat(),b=this.map.center.lng();g.mayor=g.mayor-.5*(g.mayor-b),g.menor=g.menor-.5*(g.menor-b),p.mayor=p.mayor-.5*(p.mayor-f),p.menor=p.menor-.5*(p.menor-f);var v=[{lat:p.menor,lng:g.mayor},{lat:p.menor,lng:g.menor},{lat:p.mayor,lng:g.menor},{lat:p.mayor,lng:g.mayor}];this.setState({poligonos:[].concat(Object(c.a)(o),[l]),nombre:"",color:"#ff0000",texto:JSON.stringify(v,null,2),actual:v,copiar:s,save_err:!1,deshacer:[]},function(){e.drawMap()})}},{key:"resetPoly",value:function(){var e=this,t=this.map.center.lat(),a=this.map.center.lng(),n=this.map.getBounds(),o=Object.keys(n)[0],r=Object.keys(n)[1],l=Object.keys(n[o])[0],s=Object.keys(n[o])[1],i={menor:n[r][l],mayor:n[r][s]},c={menor:n[o][l],mayor:n[o][s]};i.mayor=i.mayor-.5*(i.mayor-a),i.menor=i.menor-.5*(i.menor-a),c.mayor=c.mayor-.5*(c.mayor-t),c.menor=c.menor-.5*(c.menor-t);var d=[{lat:c.menor,lng:i.mayor},{lat:c.menor,lng:i.menor},{lat:c.mayor,lng:i.menor},{lat:c.mayor,lng:i.mayor}];this.setState({nombre:"",color:"#ff0000",texto:JSON.stringify(d,null,2),actual:d,deshacer:[]},function(){e.drawMap()})}},{key:"changeColor",value:function(e){var t=this;this.setState({color:e.target.value},function(){t.drawMap()})}},{key:"handleInputs",value:function(e){this.setState(Object(i.a)({},e.target.name,e.target.value))}},{key:"componentDidMount",value:function(){var e=this,t='{"Zones":[',a=this.state,n=a.poligonos,o=a.actual;[].concat(Object(c.a)(n),[{data:o,nombre:"Initial",color:"#ff0000"}]).forEach(function(a){t+='{"Zone":"'.concat(a.nombre,'","Coordinates":'),t+=e.formatear(a.data),t+=',"Color":"'.concat(a.color,'"'),t+="},"}),this.setState({copiar:t}),this.drawMap()}},{key:"undo",value:function(){var e=this,t=this.state.deshacer;this.setState({actual:t[t.length-1],deshacer:Object(c.a)(t.slice(0,-1)),texto:JSON.stringify(t[t.length-1])},function(){e.drawMap()})}},{key:"drawMap",value:function(){var e=this;if(!window.google)return this.timeout=setTimeout(function(){e.drawMap()},100),null;var t=this.state.center,a=t.lat,n=t.lng;this.map||(this.map=new window.google.maps.Map(document.getElementById("map-container"),{zoom:6,center:new window.google.maps.LatLng(a,n),styles:f}));var o=this.state,r=o.actual,l=o.poligonos,s=o.color;this.poligonos_guardados&&this.poligonos_guardados.forEach(function(e){e.setMap(null)}),this.poliActual&&this.poliActual.setMap(null);this.poligonos_guardados=l.map(function(t,a){var n=new window.google.maps.Polygon({paths:t.data,draggable:!1,editable:!1,strokeColor:t.color,strokeOpacity:.58,strokeWeight:2,fillColor:t.color,fillOpacity:.15});return n.setMap(e.map),n.addListener("click",function(t,a){var n="<div class='googleCuadro'>".concat(l[t].nombre,"</div>");e.infowindow&&e.infowindow.close(),e.infowindow=new window.google.maps.InfoWindow,e.infowindow.setContent(n),e.infowindow.setPosition(a.latLng),e.infowindow.open(e.map)}.bind(e,a)),n}),this.poliActual=new window.google.maps.Polygon({paths:r,draggable:!0,editable:!0,strokeColor:s,strokeOpacity:.8,strokeWeight:2,fillColor:s,fillOpacity:.35}),this.poliActual.setMap(this.map);var i=function(t){for(var a=e.poliActual.getPath().getLength(),n="",o=0;o<a;o++)n+="{"+e.poliActual.getPath().getAt(o).toUrlValue(5)+"}, ";n="["+(n=n.replace(/{/g,'{"lat":').replace(/,/g,', "lng":').replace(/, "lng": /g,",")).substring(0,n.length-1)+"]";var r=e.state,l=r.deshacer,s=r.texto,i=[];i=l.length<8?[].concat(Object(c.a)(l),[JSON.parse(s)]):[].concat(Object(c.a)(l.slice(1)),[JSON.parse(s)]);var d={texto:JSON.stringify(JSON.parse(n),null,2),actual:JSON.parse(n),deshacer:i};"dragstart"==t?d.arrastrando=!0:"dragend"==t&&(d.arrastrando=!1),(e.state.arrastrando&&"setat"==t||"dragend"==t)&&(d.deshacer=l),e.setState(d)};window.google.maps.event.addListener(this.poliActual.getPath(),"insert_at",i.bind(this,"insertat")),window.google.maps.event.addListener(this.poliActual.getPath(),"set_at",i.bind(this,"setat")),window.google.maps.event.addListener(this.poliActual,"dragend",i.bind(this,"dragend")),window.google.maps.event.addListener(this.poliActual,"dragstart",i.bind(this,"dragstart")),window.google.maps.event.addListener(this.map,"bounds_changed",function(){e.setState({center:{lat:e.map.center.lat(),lng:e.map.center.lng()}})}.bind(this)),this.setState({center:{lat:this.map.center.lat(),lng:this.map.center.lng()}})}},{key:"editPoli",value:function(e){var t=this,a=this.state.poligonos,n=a[e].data,o=a[e].color,r=a[e].nombre;this.setState({actual:n,nombre:r,color:o,poligonos:Object(c.a)(a.filter(function(t,a){return a!=e})),texto:this.formatear(n),deshacer:[]},function(){t.map=null,window.scrollTo({top:0,behavior:"smooth"}),t.drawMap();var e=Math.max.apply(null,Object(c.a)(n.map(function(e){return e.lat}))),a=Math.max.apply(null,Object(c.a)(n.map(function(e){return e.lng}))),o=Math.min.apply(null,Object(c.a)(n.map(function(e){return e.lat}))),r=Math.min.apply(null,Object(c.a)(n.map(function(e){return e.lng}))),l=new window.google.maps.LatLng(e,a),s=new window.google.maps.LatLng(o,r),i=new window.google.maps.LatLngBounds;i.extend(l),i.extend(s),t.map.fitBounds(i),t.map.panToBounds(i)})}},{key:"downloadJson",value:function(){var e=new Blob([decodeURIComponent(encodeURI(this.state.copiar))],{type:"application/json;charset=utf-8;"}),t=this.state.poligonos,a="Zones-",n=t.map(function(e){return e.nombre});a+=n.join("_");var o=new FileReader;o.onload=function(e){var t=document.createElement("a");t.href=e.target.result,t.target="_blank",t.download=a+".json";var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t.dispatchEvent(n),(window.URL||window.webkitURL).revokeObjectURL(t.href)},o.readAsDataURL(e)}},{key:"toggle",value:function(e){this.setState(Object(i.a)({},e,!this.state[e]))}},{key:"cargarJson",value:function(){var e=this,t=this.state,a=t.json_carga,n=t.poligonos,o=null;try{o=JSON.parse(a)}catch(d){return this.setState({error_json_carga:!0}),null}var r=!1;if(!("Zones"in o))return this.setState({error_json_carga:!0}),null;for(var l=0;l<o.Zones.length;l++)if(!1 in o.Zones[l]||!1 in o.Zones[l]||!1 in o.Zones[l]){r=!0;break}if(r)return this.setState({error_json_carga:!0}),null;o.Zones.forEach(function(e){n=n.filter(function(t){return t.nombre.toLowerCase()!=e.Zone.toLowerCase()})});var s=o.Zones.map(function(t){return{nombre:t.Zone,data:t.Coordinates,texto:e.formatear(t.Coordinates),color:t.Color}}),i='{"Zones":[';[].concat(Object(c.a)(n),Object(c.a)(s)).forEach(function(t){i+='{"Zone":"'.concat(t.nombre,'","Coordinates":'),i+=e.formatear(t.data),i+=',"Color":"'.concat(t.color,'"'),i+="},"}),i=i.substring(0,i.length-1)+"]}",i=JSON.stringify(JSON.parse(i),null,2),this.setState({poligonos:[].concat(Object(c.a)(n),Object(c.a)(s)),cargar_json_visible:!1,json_carga:"",copiar:i,error_json_carga:!1},function(){e.drawMap()})}},{key:"cleanJson",value:function(){this.setState({json_carga:""})}},{key:"delete",value:function(e){var t=this,a='{"Zones":[',n=Object(c.a)(this.state.poligonos.filter(function(t,a){return a!=e}));n.forEach(function(e){a+='{"Zone":"'.concat(e.nombre,'","Coordinates":'),a+=t.formatear(e.data),a+=',"Color":"'.concat(e.color,'"'),a+="},"}),a=a.substring(0,a.length-1)+"]}",this.setState({poligonos:n,copiar:a},function(){t.drawMap()})}},{key:"handleDown",value:function(e){var t=this,a=this.state,n=a.deshacer,o=a.keys;if(90!=e.keyCode&&17!=e.keyCode&&90!=e.which&&17!=e.which)return null;this.setState({keys:Object(s.a)({},o,Object(i.a)({},e.keyCode||e.which,!0))},function(){n.length>0&&t.state.keys[17]&&t.state.keys[90]&&t.undo()})}},{key:"handleUp",value:function(e){this.setState({keys:Object(s.a)({},this.state.keys,Object(i.a)({},e.keyCode||e.which,!1))})}},{key:"render",value:function(){var e=this,t=this.state,a=t.poligonos,n=t.texto,r=t.color,l=t.nombre,s=t.copiar,i=t.copiado,c=t.save_err,d=t.cargar_json_visible,m=t.json_carga,u=t.error_json_carga,h=t.deshacer;return o.a.createElement("div",{className:"generar"},d&&o.a.createElement("div",{className:"modal"},o.a.createElement("div",{className:"contenedor"},o.a.createElement("i",{className:"fas fa-times",onClick:this.toggle.bind(this,"cargar_json_visible")}),o.a.createElement("div",{className:"titulo"},"Load JSON"),o.a.createElement("div",{className:"contenido"},o.a.createElement("textarea",{name:"json_carga",onChange:this.handleInputs,value:m,placeholder:"Paste JSON"}),o.a.createElement("small",null,"Paste a JSON to add it to the map, if there is already a zone with the same name as one in the JSON, it will get replaced."),u&&o.a.createElement("p",{className:"errJson"},"JSON loaded is invalid."),o.a.createElement("button",{onClick:this.cargarJson.bind(this)},"Load Json"),o.a.createElement("button",{onClick:this.cleanJson.bind(this)},"Clean")))),o.a.createElement("div",{className:"titulo"},"Generate Coordinates"),o.a.createElement("div",{className:"elemento seccion-mapa"},o.a.createElement("div",{className:"titulo"},"Map"),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"mapa"},o.a.createElement("div",{id:"map-container",onKeyDown:this.handleDown,onKeyUp:this.handleUp}),h.length>0&&o.a.createElement("button",{className:"desh",onClick:this.undo.bind(this)},"Undo")))),o.a.createElement("div",{className:"elemento controles"},o.a.createElement("div",{className:"titulo"},"Controls"),o.a.createElement("div",{className:"content"}," ",o.a.createElement("label",null,"Zone name:"," ",o.a.createElement("input",{type:"text",name:"nombre",value:l,onChange:this.handleInputs})),o.a.createElement("label",null,"Select polygon color:",o.a.createElement("input",{type:"color",value:r,name:"color",onChange:this.changeColor})),o.a.createElement("label",null,"Current Polygon",o.a.createElement("textarea",{value:n,readOnly:!0})),o.a.createElement("div",{className:"acciones"},o.a.createElement("button",{onClick:this.savePoly},"Save current polygon"),o.a.createElement("button",{onClick:this.resetPoly},"Reset polygon"),o.a.createElement("button",{onClick:this.toggle.bind(this,"cargar_json_visible")},"Load JSON"),c&&o.a.createElement("p",{className:"save_err"},"Zone Name is empty or already in use.")))),a.length>0&&o.a.createElement("div",{className:"elemento"},o.a.createElement("div",{className:"titulo"},"Zones"),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"poligonos"},o.a.createElement("textarea",{ref:this.refPolis,value:s,readOnly:!0}),o.a.createElement("div",{className:"succ",onClick:this.copyToClipboard.bind(this)},"Copy"),o.a.createElement("div",{className:"succ",onClick:this.downloadJson.bind(this)},"Download JSON"),i&&o.a.createElement("span",null,"Copied ",o.a.createElement("i",{className:"fas fa-clipboard-check"})),o.a.createElement("small",null,"Only saved zones will be added to the final JSON"),o.a.createElement("div",{className:"botones"},o.a.createElement("h2",null,"Edit zones"),a.map(function(t,a){return o.a.createElement("div",{key:a,onClick:e.editPoli.bind(e,a),className:"poligono",style:{background:t.color},title:"Edit zone ".concat(t.nombre)},t.nombre)}),o.a.createElement("h2",null,"Delete zones"),a.map(function(t,a){return o.a.createElement("div",{key:a,onClick:e.delete.bind(e,a),className:"poligono",style:{background:t.color},title:"Delete zone ".concat(t.nombre)},t.nombre)}))))))}}]),t}(n.Component),w=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={show:!1},a.styles={position:"fixed",bottom:"0.5em",right:"0.5em",color:"white",background:"rgb(6, 127, 239)",padding:"0.7em 1em",borderRadius:"50%",zIndex:"100",cursor:"pointer",transition:"all 0.4s ease"},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.handle=this.handleScroll.bind(this),window.addEventListener("scroll",this.handle)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handle)}},{key:"handleScroll",value:function(){window.scrollY>20&&!this.state.show&&this.setState({show:!0}),window.scrollY<20&&this.state.show&&this.setState({show:!1})}},{key:"scrollTop",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return o.a.createElement("div",{className:"scrollTop",onClick:this.scrollTop.bind(this),style:Object(s.a)({},this.styles,{transform:this.state.show?"":"translateY(150%)"})},o.a.createElement("i",{className:"fas fa-arrow-up"}))}}]),t}(n.Component);var k=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(w,null),o.a.createElement(y,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},88:function(e){e.exports=[{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#466380"},{visibility:"on"},{weight:1}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#466380"},{visibility:"on"},{weight:5.5}]}]},89:function(e,t,a){e.exports=a(198)}},[[89,1,2]]]);
//# sourceMappingURL=main.760e3240.chunk.js.map